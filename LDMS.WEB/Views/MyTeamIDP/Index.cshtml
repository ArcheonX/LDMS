@{
    ViewData["Title"] = "My Monitoring";
    ViewData["MainTitle"] = "My Team";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

    <div class="panel panel-primary" style="margin-top:-15px;width:100%;">
        <div class="panel panel-default" style="width:100%;border-width:thin;border-style:solid;">
            @*//Search Panel*@
            <div class="panel-body" style="width:100%;">
                <form method="post">
                    @Html.AntiForgeryToken()  @*CSRF Protected*@
                    
                    <div class="form-horizontal" style="margin-top:25px">
                        <div class="row form-group">
                            <div class="col-sm-2 col-md-2">
                                <span class="pull-right">
                                    <label class="LabelCaption">Plant</label>
                                </span>
                            </div>
                            <div class="col-4">
                                <div class="btn-group">
                                    <select id="selectPlant" name="selectPlant" class="form-control" style="width: 100%">
                                    </select>
                                </div>
                            </div>
                            <div class="col-sm-2 col-md-2 ">
                                <span class="pull-right">
                                    <label class="LabelCaption">Center</label>
                                </span>
                            </div>
                            <div class="col-4">
                                <div class="btn-group">
                                    <select id="selectCenter" name="selectCenter" class="form-control" style="width: 100%">
                                    </select>
                                </div>
                            </div>
                            @*</div>*@
                        </div>
                      
                        <div class="row form-group">
                            <div class="col-sm-2 col-md-2">
                                <span class="pull-right">
                                    <label class="LabelCaption">Division</label>
                                </span>
                            </div>
                            <div class="col-4">
                                <div class="btn-group">
                                    <select id="selectDivision" name="selectDivision" class="form-control" style="width: 100%">
                                    </select>
                                </div>
                            </div>
                            <div class="col-sm-2 col-md-2">
                                <span class="pull-right">
                                    <label class="LabelCaption">Department</label>
                                </span>
                            </div>
                            <div class="col-4">
                                <div class="btn-group">
                                    <select id="selectDepartment" name="selectDepartment" class="form-control" style="width: 100%">
                                    </select>
                                </div>
                            </div>
                        </div>
                       
                        <div class="row form-group">
                            <div class="col-sm-2 col-md-2">
                                <span class="pull-right">
                                    <label class="LabelCaption">Status</label>
                                </span>
                            </div>
                            <div class="col-4">
                                <div class="btn-group">
                                    <select id="selectStatus" name="selectStatus" class="form-control" style="width: 100%">
                                    </select>
                                </div>
                            </div>                            
                        </div>
                        <div class="row form-group">
                            <div class="col-sm-2 col-md-2">
                                <span class="pull-right">
                                    <label class="LabelCaption">Employee</label>
                                </span>
                            </div>
                            <div class="col-sm-4 col-md-4">
                                <input type="text" id="txtFilterEmployeeID" class="form-control input-sm" />
                            </div>
                        </div>

                        <div class="row form-group">
                            <div class="col-sm-2 col-md-2 offset-9">
                                <a id="btnSeacrh" class="btn btn-info waves-effect waves-light" style="width:100%; color:white;" onclick="Search()"> Search </a>
                            </div>

                        </div>
                        </div>
                </form>
            </div>
        </div>
        <div class="table-responsive m-t-40">
            @* Result Panel *@
            <table class="display dataTable" width="100%" id="dtCourseList">
                <thead>
                    <tr>
                        <th style="text-align:center;width:100px">Name:</th>
                        <th style="text-align:center;width:150px">Position:</th>
                        <th style="text-align:center;width:150px">Service(Year):</th>
                        <th style="text-align:center;width:150px">IDP Time Line:</th>
                        <th style="text-align:center;width:150px">IDP Start:</th>
                        <th style="text-align: center;width:50px">IDP End:</th>
                        <th style="text-align:center;width:50px">IDP Objective</th>
                        <th style="text-align:center;width:50px">Total Review</th>
                        <th style="text-align:center;width:50px">IDP Status</th>
                        <th style="text-align:center;width:50px">Update Date</th>
                        <th style="text-align:center;width:50px">Update Time</th>
                    </tr>
                </thead>
                <tbody>
                </tbody>
            </table>
        </div>

        <script type="text/javascript">
            $(document).ready(function () {
                $("txtFilterEmployeeID").val(CookiesController.getCookie("PlantID"));
                LoadData();
                $("#selectPlant").change(function () {
                    //$("#additionalOptions").show();
                    changePlant(this);
                });

                $("#selectCenter").change(function () {
                    //$("#additionalOptions").show();
                    changeCenter(this);
                });

                $("#selectDivision").change(function () {
                    //$("#additionalOptions").show();
                    changeDivision(this);
                });
            };

            function LoadData() {
                

                    loadPlant();
                    
                    $('txtFilterEmployeeID').val(CookiesController.getCookie("PlantID"));
                    //loadCenter();
                    //loadDivision();
                    //loadDepartment();
                    //loadSection();

                    ReloadCenter($, $('#selectPlant').val(), null);
                    ReloadDivision($, $('#hID_DivisionTarget').val(), null);
                    
                    

                    
               
            }

            function changePlant(sel) {
                //alert('changePlant');
                $('#selectDivision').empty();
                $('#selectDepartment').empty();
                $('#selectSection').empty();

                var plantid = sel.value;
                ReloadCenter($, plantid, null);
            }

            function changeCenter(sel) {
                //alert('changeCenter');
                $('#selectDepartment').empty();
                $('#selectSection').empty();

                var centerId = sel.value;
                ReloadDivision($, centerId, null);
            }

            function changeDivision(sel) {
                // alert('changeDivision');
                $('#selectSection').empty();
                var divisionId = sel.value;
                ReloadDepartment($, divisionId, null);
            }

            function changeDepartment(sel) {
                //alert('changeDepartment');

                var departmentId = sel.value;
                ReloadSection($, departmentId, null);
            }

            function loadPlant() {
                //alert(' loadPlant');
                $.ajax({
                    type: "GET",
                    url: "/Master/GetAllPlants",
                    success: function (response) {
                        var options = $('#selectPlant');
                        options.append($("<option />").val(null).text("Please select"));
                        $.each(response.Data, function () {
                            options.append($("<option />").val(this.ID).text(this.PlantName_EN));
                        });
                        $('select[name="selectPlant"]').val($('#selectPlant').val()).trigger('change');
                    },
                    failure: function (response) {
                        MessageController.Error(response.responseText, "Error");
                    },
                    error: function (response) {
                        MessageController.Error(response.responseText, "Error");
                    }
                });
            }

            function loadCenter() {
                //alert('loadCenter');
                $.ajax({
                    type: "GET",
                    url: "/Master/GetAllCenters",
                    success: function (response) {
                        var options = $('#selectCenter');
                        options.append($("<option />").val(null).text("Please select"));
                        $.each(response.Data, function () {
                            options.append($("<option />").val(this.ID).text(this.CenterName_EN));
                        });
                        $('select[name="selectCenter"]').val($('#hID_CenterTarget').val()).trigger('change');
                    },
                    failure: function (response) {
                        MessageController.Error(response.responseText, "Error");
                    },
                    error: function (response) {
                        MessageController.Error(response.responseText, "Error");
                    }
                });
            }

            function loadDivision() {

                //alert('loadDivision');
                $.ajax({
                    type: "GET",
                    url: "/Master/GetAllDivisions",
                    success: function (response) {
                        var options = $('#selectDivision');
                        options.append($("<option />").val(null).text("Please select"));
                        $.each(response.Data, function () {
                            options.append($("<option />").val(this.ID).text('(' + this.DivisionID + ') ' + this.DivisionName_EN));
                        });

                        $('select[name="selectDivision"]').val($('#hID_DivisionTarget').val()).trigger('change');

                    },
                    failure: function (response) {
                        MessageController.Error(response.responseText, "Error");
                    },
                    error: function (response) {
                        MessageController.Error(response.responseText, "Error");
                    }
                });
            }

            function loadDepartment() {
                //alert('loadDepartment');
                $.ajax({
                    type: "GET",
                    url: "/Master/GetAllDepartments",
                    success: function (response) {
                        var options = $('#selectDepartment');
                        var optionsMod = $('#selectEmpDepartment');
                        options.append($("<option />").val(null).text("Please select"));
                        optionsMod.append($("<option />").val(null).text("Please select"));

                        $.each(response.Data, function () {
                            options.append($("<option />").val(this.ID_Department).text('(' + this.DepartmentID + ') ' + this.DepartmentName_EN));
                            optionsMod.append($("<option />").val(this.ID_Department).text('(' + this.DepartmentID + ') ' + this.DepartmentName_EN));
                        });
                        $('select[name="selectDepartment"]').val($('#hID_DepartmentTarget').val()).trigger('change');
                        $('select[name="selectEmpDepartment"]').val(null).trigger('change');
                    },
                    failure: function (response) {
                        alert(response.responseText);
                    },
                    error: function (response) {
                        alert(response.responseText);
                    }
                });
            }

            function ReloadCenter($, plantId, callback) {
                var options = $('#selectCenter');
                options.empty();
                if (plantId && plantId != "") {
                    $.ajax({
                        type: "GET",
                        url: "/Master/GetAllCentersByPlant",
                        data: {
                            plantId: plantId
                        },
                        success: function (response) {
                            options.append($("<option />").val(null).text("Please select"));
                            $.each(response.Data, function () {
                                //if (this.ID_Plant == plantId) {
                                options.append($("<option />").val(this.ID).text(this.CenterName_EN));
                                //}
                            });
                            $('select[name="selectCenter"]').val($('#hID_CenterTarget').val()).trigger('change');
                            document.getElementById("selectCenter").disabled = false;
                            // ReloadDivision($, $('#hID_CenterTarget').val(), null);
                            if (callback) {
                                //callback($("#userDivisionId").val());
                            }
                        },
                        failure: function (response) {
                            MessageController.Error(response.responseText, "Error");
                        },
                        error: function (response) {
                            MessageController.Error(response.responseText, "Error");
                        }
                    });



                }
            }

            function ReloadDivision($, centerId, callback) {
                //alert('ReloadDivision : ' + centerId);

                var options = $('#selectDivision');
                options.empty();
                if (centerId && centerId != "") {
                    $.ajax({
                        type: "GET",
                        url: "/Master/GetAllDivisionsByCenter",
                        data: {
                            centerId: centerId
                        },
                        success: function (response) {
                            options.append($("<option />").val(null).text("Please select"));
                            $.each(response.Data, function () {
                                //if (this.ID_Center == centerId) {
                                options.append($("<option />").val(this.ID).text('(' + this.DivisionID + ') ' + this.DivisionName_EN));
                                //}
                            });
                            $('select[name="selectDivision"]').val($('#hID_DivisionTarget').val()).trigger('change');
                            document.getElementById("selectDivision").disabled = false;
                            //ReloadDepartment($, $('#hID_DivisionTarget').val(), null);

                            if (callback) {
                                //callback($("#userDivisionId").val());
                            }
                        },
                        failure: function (response) {
                            MessageController.Error(response.responseText, "Error");
                        },
                        error: function (response) {
                            MessageController.Error(response.responseText, "Error");
                        }
                    });
                }
            }

            function ReloadDepartment($, divisionId, callback) {
                var options = $('#selectDepartment');
                options.empty();
                if (divisionId && divisionId != "") {
                    $.ajax({
                        type: "GET",
                        url: "/Master/GetAllDepartmentsByDivision",
                        data: {
                            divisionId: divisionId
                        },
                        success: function (response) {

                            options.append($("<option />").val(null).text("Please select"));
                            $.each(response.Data, function () {
                                //if (this.ID_Division == divisionId) {
                                options.append($("<option />").val(this.ID_Department).text('(' + this.DepartmentID + ') ' + this.DepartmentName_EN));
                                //}
                            });

                            $('select[name="selectDepartment"]').val($('#hID_DepartmentTarget').val()).trigger('change');
                            document.getElementById("selectDepartment").disabled = false;
                            //ReloadSection($, $('#hID_DepartmentTarget').val(), null);

                            if (callback) {
                                //callback($("#userDepartmentId").val());
                            }
                        },
                        failure: function (response) {
                            MessageController.Error(response.responseText, "Error");
                        },
                        error: function (response) {
                            MessageController.Error(response.responseText, "Error");
                        }
                    });
                }
            }
        </script>
</div >
